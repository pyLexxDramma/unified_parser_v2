# Инструкция по настройке бизнес-аккаунта 2ГИС

## Что реализовано

✅ **Базовая структура для логина в бизнес-аккаунт 2ГИС:**
- Добавлена конфигурация для учетных данных
- Реализован метод `_login_to_business_account()` для автоматического входа
- Реализован метод `_apply_review_filters()` для применения фильтров отзывов
- Интегрировано в основной метод парсинга

## Настройка

### Вариант 1: Через `.env` файл (рекомендуется)

Добавьте в файл `.env`:

```env
2GIS_BUSINESS_ENABLED=true
2GIS_BUSINESS_EMAIL=your_email@example.com
2GIS_BUSINESS_PASSWORD=your_password
```

### Вариант 2: Через `config.json`

Добавьте в `config/config.json`:

```json
{
  "2gis_business": {
    "enabled": true,
    "email": "your_email@example.com",
    "password": "your_password"
  }
}
```

⚠️ **Важно:** Не коммитьте файлы с паролями в git! Добавьте `.env` в `.gitignore`.

## Что нужно сделать дальше

### 1. Изучить структуру страницы входа

**Когда вы предоставите доступ, нужно будет:**
- Определить точный URL страницы входа
- Найти селекторы для полей email и password
- Найти селектор кнопки входа
- Проверить, есть ли капча или двухфакторная аутентификация

**Метод `_login_to_business_account()` уже пытается:**
- Найти страницу входа (пробует несколько вариантов URL)
- Найти поля ввода (пробует разные селекторы)
- Ввести данные и нажать кнопку входа
- Проверить успешность логина

**После предоставления доступа:**
- Я изучу HTML страницы входа
- Уточню селекторы
- Сохраню HTML в `debug/2gis_login/` для анализа

### 2. Изучить структуру страницы карточки в бизнес-аккаунте

**Нужно определить:**
- Формат URL карточки в бизнес-аккаунте
- Где находятся фильтры отзывов (селекторы)
- Отличается ли структура отзывов от публичной страницы

**Метод `_apply_review_filters()` уже пытается:**
- Найти кнопки фильтров по тексту ("Все", "Положительные", "Отрицательные", "С ответами")
- Кликнуть на нужный фильтр
- Дождаться применения фильтра

**После предоставления доступа:**
- Я изучу HTML страницы карточки
- Уточню селекторы фильтров
- Проверю структуру отзывов

### 3. Протестировать логин и фильтры

После изучения структуры:
- Протестируем логин на реальных данных
- Протестируем применение фильтров
- Сравним результаты с публичной страницей

## Текущая реализация

### Метод логина (`_login_to_business_account`)

**Что делает:**
1. Пробует найти страницу входа (несколько вариантов URL)
2. Ищет поля email и password (разные селекторы)
3. Вводит данные
4. Ищет и кликает кнопку входа
5. Проверяет успешность логина

**Что нужно уточнить:**
- Точный URL страницы входа
- Точные селекторы полей
- Селектор кнопки входа

### Метод применения фильтров (`_apply_review_filters`)

**Что делает:**
1. Ищет кнопки фильтров по тексту
2. Кликает на нужный фильтр
3. Ждет применения фильтра

**Что нужно уточнить:**
- Точные селекторы кнопок фильтров
- Структуру фильтров (могут быть вкладки, кнопки, dropdown)

## Следующие шаги

1. **Предоставьте данные для входа:**
   - Email
   - Пароль
   - (Опционально) Скриншоты страницы входа и страницы карточки

2. **Я изучу структуру:**
   - Сохраню HTML страниц в `debug/2gis_login/` и `debug/2gis_business/`
   - Определю точные селекторы
   - Обновлю код с правильными селекторами

3. **Протестируем:**
   - Логин
   - Применение фильтров
   - Парсинг отзывов с фильтрами

## Безопасность

⚠️ **Важно:**
- Храните пароли в `.env` файле (не в `config.json`)
- Добавьте `.env` в `.gitignore`
- Не коммитьте файлы с паролями
- Используйте переменные окружения на продакшене

## Пример использования

После настройки, парсер автоматически:
1. Проверит, включен ли бизнес-аккаунт
2. Если да - выполнит логин
3. При парсинге отзывов будет использовать фильтры (если нужно)
4. Если логин не удался - использует публичный доступ

**В логах будет видно:**
```
Вход в бизнес-аккаунт 2ГИС...
Successfully logged into 2GIS business account
Using business account, navigating to reviews page: ...
Applying review filter: positive
```





